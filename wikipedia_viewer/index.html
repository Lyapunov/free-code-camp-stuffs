<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<!-- 
  CSS 
-->
<style>
html, body {
  background-color:darkblue;
  width: 99%;
  height: 100%;
}

.viewer-text {
  color:lightblue;
}

.vhundred {
  height:100%;
  width:100%;
}

.vforty {
  height:40%;
}

.centered {
   white-space: normal;
   overflow-wrap:break-word;
   text-align: center;
   display: table-cell;
   justify-content: center;
   vertical-align:middle;
}

.invisible {
   display:none;
}

.noselect {
  -webkit-touch-callout: none; /* iOS Safari */
    -webkit-user-select: none; /* Safari */
     -khtml-user-select: none; /* Konqueror HTML */
       -moz-user-select: none; /* Firefox */
        -ms-user-select: none; /* Internet Explorer/Edge */
            user-select: none; /* Non-prefixed version, currently
                                  supported by Chrome and Opera */
}
</style>

<!-- 
  JS 
-->
<script>

// https://www.mediawiki.org/wiki/API:Search_and_discovery
// https://en.wikipedia.org/w/api.php?action=query&list=search&srsearch=Albert%20Einstein

/* $.ajax({
  url: 'https://en.wikipedia.org/w/api.php',
  data: { action: 'query', list: 'search', srsearch: 'Richard Feyman', format: 'json' },
  dataType: 'jsonp',
  success: function (x) {
    console.log('title', x.query.search[0].title);
  }
}); */

// --------------------------------------------------------------------

// https://www.mediawiki.org/wiki/API:Prefixsearch
// https://www.mediawiki.org/w/api.php?action=query&list=prefixsearch&pssearch=Fay&format=json&

$.ajax({
  url: 'https://en.wikipedia.org/w/api.php',
  data: { action: 'query', list: 'prefixsearch', pssearch: 'Richard', psprofile: 'fuzzy', format:'json' },
  dataType: 'jsonp',
  success: function (x) {
    console.log(x);
    console.log('title', x.query.prefixsearch[0].title);
    console.log('title', x.query.prefixsearch[1].title);
    console.log('title', x.query.prefixsearch[2].title);
  }
});

var closerVar;

function wikisearch_input_oninput() {
   // https://jsfiddle.net/gsj5o3j6/4/

   console.log("xxx");
   if ($('.dropdown').find('.dropdown-menu').is(":hidden"))
   {
      console.log('openi!');
      $('.dropdown-toggle').dropdown('toggle');
      closerVar = setTimeout(wikisearch_input_timeout, 3000);
   }
}

function wikisearch_input_timeout() {
   console.log("boom");
   $('.dropdown.open').removeClass('open');
}

</script>

<!-- 
  HTML  
-->

<body>
  <div id="viewer-main-div" class="vhundred">
    <div id="viewer-gap-upper" class="vforty">
    </div>
    <div id="viewer-panel-1" class="row container-fluid">
      <div class="col-md-2"></div>
      <div class="col-md-8 centered">
         <p class="viewer-text noselect">Searching in wikipedia</p>
      </div>
    </div>
    <div id="viewer-panel-2" class="row container-fluid">
      <div class="col-md-2"></div>
      <div class="col-md-8">
         <input id="viewer-input" class="span2" data-toggle="dropdown" id="appendedInputButton" size="16" type="text" oninput="wikisearch_input_oninput();" data-toggle="dropdown"/>
         </input>
      </div>
      <div class="col-md-2"></div>
    </div>
    <div id="viewer-panel-3" class="row container-fluid">
      <div class="col-md-2"></div>
      <div class="col-md-8 dropdown">
          <ul class="dropdown-menu">
              <li id="viewer-dropdown-item1"><a href="#">Action</a></li>
              <li id="viewer-dropdown-item2"><a href="#">Another action</a></li>
              <li id="viewer-dropdown-item3"><a href="#">Another action 2</a></li>
              <li id="viewer-dropdown-item4"><a href="#">Another action 3</a></li>
              <li id="viewer-dropdown-item5"><a href="#">Another action 4</a></li>
          </ul>
          <a href="#" data-toggle="dropdown" class="dropdown-toggle invisible">Dropdown<b class="caret"></b></a>
      </div>
      <div class="col-md-2"></div>
    </div>
  </div>
</body>
